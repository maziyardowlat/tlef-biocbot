<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat History - BiocBot Student</title>
    
    <!-- Favicon - UBC Logo -->
    <link rel="icon" type="image/x-icon" href="../assets/images/favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="../assets/images/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../assets/images/favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="../assets/images/apple-touch-icon.png">
    <link rel="manifest" href="../assets/images/site.webmanifest">
    
    <link rel="stylesheet" href="../styles/style.css">
    <link rel="stylesheet" href="../styles/chat.css">
    <link rel="stylesheet" href="../styles/agreement-modal.css">
</head>
<body>
    <div class="app-container">
        <!-- Sidebar Navigation -->
        <aside class="sidebar">
            <div class="logo-container">
                <h2>BiocBot</h2>
            </div>
            <nav class="main-nav">
                <ul>
                    <li><a href="/student"><span class="icon"></span> Chat</a></li>
                    <li class="active"><a href="/student/history"><span class="icon"></span> Chat History</a></li>
                    <li><a href="/student/flagged"><span class="icon"></span> Flagged</a></li>
                    <li><a href="/student/dashboard.html"><span class="icon"></span> Topic Dashboard</a></li>
                    <li class="mobile-only-nav"><a href="#" id="mobile-logout-btn"><span class="icon"></span> Logout</a></li>
                </ul>
            </nav>
            <div class="user-info">
                <div class="user-avatar">S</div>
                <div class="user-name" id="user-display-name">Student Name</div>
                <div class="user-role">Student</div>
                <div class="user-actions">
                    <a href="#" id="logout-btn" class="user-action">Logout</a>
                </div>
            </div>
        </aside>

        <!-- Main Content Area -->
        <main class="main-content">

            <!-- Chat History List -->
            <div class="history-container">
                <div class="chat-history-list">
                    <div class="history-header">
                        <h3>Chat History</h3>
                    </div>
                    <div id="chat-history-list" class="history-items">
                        <!-- Chat history items will be loaded dynamically -->
                    </div>
                    <div id="no-history-message" class="no-history" style="display: none;">
                        <div class="no-history-content">
                            <div class="no-history-icon">üí¨</div>
                            <h4>No Chat History</h4>
                            <p>You haven't saved any chats yet. Start a conversation and save it to see it here!</p>
                            <a href="/student" class="primary-button">Start New Chat</a>
                        </div>
                    </div>
                </div>
                
                <!-- Chat Preview Panel -->
                <div class="chat-preview-panel">
                    <div class="preview-header">
                        <button id="mobile-back-btn" class="mobile-back-btn" style="display: none;">‚Üê Back</button>
                        <h2 id="preview-title">Select a Chat</h2>
                        <div class="preview-actions" id="preview-actions" style="display: none;">
                            <button id="continue-chat-btn" class="primary-button">Continue Chat</button>
                            <button id="download-md-btn" class="secondary-button" title="Download as Markdown">Download Markdown</button>
                            <button id="delete-chat-btn" class="secondary-button">Delete</button>
                        </div>
                    </div>
                    
                    <div class="preview-messages" id="preview-messages">
                        <div class="no-selection">
                            <div class="no-selection-content">
                                <div class="no-selection-icon">üìã</div>
                                <h4>No Chat Selected</h4>
                                <p>Select a chat from the list to view its contents and continue the conversation.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
    <script src="../common/scripts/auth.js"></script>
    <script src="../common/scripts/agreement-modal.js"></script>
    <script src="./scripts/flag-notifications.js"></script>
    <script src="../common/scripts/mobile-layout.js"></script>
    <script src="../common/scripts/idle-timer.js"></script>
    <script src="./scripts/history.js"></script>
    <script>
        // Initialize flag notifications after DOM is ready
        document.addEventListener('DOMContentLoaded', async () => {
            // Wait a bit for auth to initialize
            setTimeout(async () => {
                try {
                    await initializeFlagNotifications();
                } catch (error) {
                    console.error('Error initializing flag notifications:', error);
                }
            }, 1000);
        });
    </script>
</body>
</html> 